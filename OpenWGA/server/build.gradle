apply plugin: 'java'
apply plugin: 'war'
apply plugin: 'maven-publish'

compileJava.options.encoding = 'ISO-8859-1'
ant.basedir=project.rootDir

dependencies {
    compile project(":wga");
    compile project(":tmlScript");
    
    compileClasspath project(":wgaBuildTools");
}


task writeVersion << {
    ant.taskdef(name:"writeVersion", classname:"de.innovationgate.ant.WriteVersionTask", classpath: configurations.compileClasspath.asPath)
    ant.writeVersion(target:"server/build/tmp/wgabuild.properties", version: rootProject.version)
    println "Wrote OpenWGA Version: ${rootProject.version}"
}

compileJava.doLast {
    tasks.writeVersion.execute()
}

publishing {
    publications {
        mavenJava(MavenPublication) {
            from components.web
        }
    }
}

war {
    war.archiveName = "openwga-ce.war"
    from('build/tmp') {
        include 'wgabuild.properties' into('WEB-INF')
    }
}

